rem Copyright (C) 2007-2008 Alexander M. Batishchev aka Godfather (abatishchev at gmail.com)

set PATH=%PATH%;%WINDIR%\Microsoft.NET\Framework\v3.5;%PROGRAMFILES%\WinRar;

set CMD=A -afzip -o+ -s -ibck -t -m5

set PROJECT=reg2run

set FILES=Reg2Run.csproj Reg2Run.sln App.manifest
set SOURCES=ApplicationSettings.cs Core.cs Errors.cs Extensions.cs ImportObject.cs ManualConsole.cs Program.cs Properties\AssemblyInfo.cs
set DOCS=CHANGELOG.txt LICENSE.txt
set FILES=%FILES% %SOURCES% %DOCS%

set BINARY=bin\Release\reg2run.exe

set MAJOR=2
set MINOR=1
set BUILD=8
set REVISION=$WCREV$
set VERSION=%MAJOR%.%MINOR%.%BUILD%.%REVISION%

set DIST=..\release
mkdir %DIST%

msbuild /nologo %PROJECT%.sln /t:Clean /p:Configuration=Release
msbuild /nologo %PROJECT%.sln /t:Build /p:Configuration=Release

set NAME=%PROJECT%-%VERSION%-source.zip
winrar.exe %CMD% %NAME% %FILES%
move /y %NAME% %DIST%

set NAME=%PROJECT%-%VERSION%-binary.zip
winrar.exe -ep %CMD% %NAME% %BINARY%
move /y %NAME% %DIST%