rem Copyright (C) 2007-2008 Alexander M. Batishchev aka Godfather (abatishchev at gmail.com)

set PATH=%PATH%;%PROGRAMFILES%\WinRar;%PROGRAMFILES%\PuTTY

set CMD=A -afzip -o+ -s -ibck -t -m5

set PROJECT=reg2run

set FILES=Reg2Run.csproj Reg2Run.sln App.manifest
set SOURCES=ApplicationSettings.cs Core.cs Errors.cs Extensions.cs ImportObject.cs ManualConsole.cs Program.cs Properties\AssemblyInfo.cs
set DOCS=CHANGELOG.txt LICENSE.txt
set FILES=%FILES% %SOURCES% %DOCS%

set BINARY=bin\Release\reg2run.exe

set MAJOR=2
set MINOR=1
set BUILD=8
set REVISION=$WCREV$
set VERSION=%MAJOR%.%MINOR%.%BUILD%.%REVISION%

set BATCH=batch.txt
del %BATCH%
echo cd uploads >> %BATCH%

set NAME=%PROJECT%-%VERSION%-source.zip
winrar.exe %CMD% %NAME% %FILES%
echo put %NAME% >> %BATCH%

set NAME=%PROJECT%-%VERSION%-binary.zip
winrar.exe -ep %CMD% %NAME% %BINARY%
echo put %NAME% >> %BATCH%

psftp.exe -b %BATCH% abatishchev@frs.sourceforge.net

del %BATCH%

set DIST=..\release

mkdir %DIST%
move /y %PROJECT%-%VERSION%-source.zip %DIST%
move /y %PROJECT%-%VERSION%-binary.zip %DIST%
